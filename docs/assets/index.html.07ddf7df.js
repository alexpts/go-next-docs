import{_ as i,a as l}from"./401.09c2255f.js";import{_ as u,r as c,o as r,c as d,a as n,d as a,w as e,e as k,b as s,f as p}from"./app.f2fd8a86.js";const v={},b=n("h1",{id:"\u0431\u044B\u0441\u0442\u0440\u044B\u0438-\u0441\u0442\u0430\u0440\u0442",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u0431\u044B\u0441\u0442\u0440\u044B\u0438-\u0441\u0442\u0430\u0440\u0442","aria-hidden":"true"},"#"),s(" \u0411\u044B\u0441\u0442\u0440\u044B\u0439 \u0441\u0442\u0430\u0440\u0442")],-1),m={class:"table-of-contents"},h=s("Hello World"),g=s("\u0413\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0439"),f=s("\u0421\u043B\u043E\u0438"),x=s("Handler / \u041E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A"),y=s("Options"),_=s("\u0411\u044B\u0441\u0442\u0440\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B (\u0441\u0430\u0445\u0430\u0440)"),w=s("\u0414\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F \u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F"),q=s("Inline \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432 \u0432 uri"),H=s("Flow"),R=s("Fasthttp"),A=s("\u0418\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F"),C=s("net.http"),P=s("\u0410\u0434\u0430\u043F\u0442\u0435\u0440"),N=n("hr",null,null,-1),L={class:"custom-container tip"},S=n("p",{class:"custom-container-title"},"\u041F\u0440\u0435\u0434\u044B\u0441\u0442\u043E\u0440\u0438\u044F",-1),F=s("Next \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E\u0439 \u0432\u0435\u0440\u0441\u0438\u0435\u0439 \u043C\u0438\u043A\u0440\u043E\u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u043A\u0430 "),M={href:"https://github.com/alexpts/php-next2",target:"_blank",rel:"noopener noreferrer"},T=s("php-next2"),B=s("."),U=p(`<h2 id="hello-world" tabindex="-1"><a class="header-anchor" href="#hello-world" aria-hidden="true">#</a> Hello World</h2><p>\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> app<span class="token punctuation">.</span>FasthttpHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438" tabindex="-1"><a class="header-anchor" href="#\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438" aria-hidden="true">#</a> \u0413\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0439</h2><h4 id="middleware-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A-\u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E-\u0443\u0440\u043E\u0432\u043D\u044F" tabindex="-1"><a class="header-anchor" href="#middleware-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A-\u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E-\u0443\u0440\u043E\u0432\u043D\u044F" aria-hidden="true">#</a> Middleware (\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u043F\u0440\u043E\u043C\u0435\u0436\u0443\u0442\u043E\u0447\u043D\u043E\u0433\u043E \u0443\u0440\u043E\u0432\u043D\u044F)</h4><p>Middleware - \u044D\u0442\u043E \u0447\u0430\u0441\u0442\u044C \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u043E\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043A\u043E\u043D\u043A\u0440\u0435\u0442\u043D\u0443\u044E \u0435\u0434\u0438\u043D\u0438\u0446\u0443 \u043B\u043E\u0433\u0438\u043A\u0438 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 request/response.</p><h4 id="layer-\u0441\u043B\u043E\u0438" tabindex="-1"><a class="header-anchor" href="#layer-\u0441\u043B\u043E\u0438" aria-hidden="true">#</a> Layer / \u0421\u043B\u043E\u0439</h4><p>\u042D\u0442\u043E \u0430\u0431\u0441\u0442\u0440\u0430\u043A\u0446\u0438\u044F \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u043E \u0441\u0443\u0442\u0438 middleware. Layer \u043C\u043E\u0436\u0435\u0442 \u0438\u043C\u0435\u0442\u044C \u043A\u0430\u043A 1 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u0442\u0430\u043A \u0438 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E, \u0447\u0442\u043E\u0431\u044B \u0434\u0435\u043A\u043E\u043C\u043F\u043E\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043D\u0430 \u0431\u043E\u043B\u0435\u0435 \u043C\u0435\u043B\u043A\u0438\u0435 \u0447\u0430\u0441\u0442\u0438 \u043A\u043E\u0434.</p><h4 id="\u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435" tabindex="-1"><a class="header-anchor" href="#\u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435" aria-hidden="true">#</a> \u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435</h4><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0441\u0430\u043C\u044B\u043C \u0432\u044B\u0441\u043E\u043A\u0438\u043C \u0443\u0440\u043E\u0432\u043D\u0435\u043C \u0438 \u0440\u0435\u0430\u043B\u0437\u0438\u0443\u0435\u0442 \u043F\u043E\u043B\u043D\u043E\u0443\u044E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430. \u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044D\u0442\u043E \u043D\u0430\u0431\u043E\u0440 Layers, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0434\u043B\u044F \u043A\u0430\u0436\u0434\u043E\u0433\u043E http \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0438\u043D\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043B\u044C\u043D\u043E. \u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043D\u0430 \u0432\u0445\u043E\u0434\u0435 http request \u0438 \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response.</p><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043E\u0441\u043E\u0437\u043D\u0430\u043D\u043E \u0441\u0432\u043E\u0434\u0438\u0442 \u0447\u0438\u0441\u043B\u043E \u0441\u0443\u0449\u043D\u043E\u0441\u0442\u0435\u0439 \u043A \u043C\u0438\u043D\u0438\u043C\u0443\u043C\u0443, \u0447\u0442\u043E\u0431\u044B \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u043F\u0440\u043E\u0441\u0442\u044B\u043C, \u043F\u043E\u043D\u044F\u0442\u043D\u044B\u043C \u0438 \u043D\u0430\u0434\u0435\u0436\u043D\u044B\u043C. \u041E\u0441\u043D\u043E\u0432\u043D\u043E\u0435 \u043F\u043E\u043D\u044F\u0442\u0438\u0435 \u0441 \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u043F\u0440\u0438\u0434\u0435\u0442\u0441\u044F \u043F\u043E\u0441\u0442\u043E\u044F\u043D\u043D\u043E \u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u044D\u0442\u043E Layer (\u0421\u043B\u043E\u0439).</p><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u0438\u043D\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442 \u043D\u0430 \u0432\u0445\u043E\u0434 \u043E\u0431\u044A\u0435\u043A\u0442 <code>fasthttp.RequestCtx</code> \u0438 \u043F\u0440\u043E\u0433\u043E\u043D\u044F\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 \u0432\u0441\u0435 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0438 \u0441\u043B\u043E\u0435\u0432. \u041A\u0430\u043A\u0438\u0435 \u0438\u043C\u0435\u043D\u043D\u043E \u0441\u043B\u043E\u0438 \u043F\u0440\u0438\u043C\u0443\u0442 \u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0435\u0442\u0430\u0438\u0444\u043D\u043E\u0440\u043C\u0430\u0446\u0438\u0435\u0439 \u0441\u043B\u043E\u044F. \u0421\u0435\u043C\u0430\u043D\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u043C\u043E\u0436\u043D\u043E \u0432\u044B\u0434\u0435\u043B\u0438\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0435 \u0442\u0438\u043F\u044B \u0441\u043B\u043E\u0435\u0432:</p><ul><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u043C \u0437\u0430\u043F\u0440\u043E\u0441\u0435</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044E uri \u0432 \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u043E\u043C \u0432\u044B\u0440\u0430\u0436\u0435\u043D\u0438\u0438</li><li>\u0410\u043A\u0442\u0438\u0447\u0430\u0446\u0438\u044F \u043F\u043E \u043A\u0430\u0441\u0442\u043E\u043C\u043D\u043E\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438</li></ul><details class="custom-container details"><summary>\u0421\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0435 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438</summary><p>\u0418\u0437 \u043A\u043E\u0440\u043E\u0431\u043A\u0438 \u0438\u0434\u0435\u0442 \u043C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \u0441\u0442\u0440\u0430\u0442\u0435\u043D\u0438\u0439 (\u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443 \u0438 \u043F\u043E\u0438\u0441\u043A \u043F\u043E uri). \u041C\u043E\u0436\u043D\u043E \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u0442\u044C \u043B\u044E\u0431\u044B\u0435 \u043A\u0430\u0441\u0442\u043E\u043C\u043D\u044B\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u0430, \u043F\u043E \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u0431\u0443\u0434\u0435\u0442 \u043F\u0440\u0438\u043D\u044F\u0442\u043E \u0440\u0435\u0448\u0435\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043B\u0438 \u0441\u043B\u043E\u044F \u0434\u043B\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0438\u043B\u0438 \u043D\u0435\u0442. \u0414\u043B\u044F \u044D\u0442\u043E\u0433\u043E \u043D\u0443\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0432\u043E\u044E \u0440\u0435\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044E <code>next.ResolverContract</code></p></details><h2 id="\u0441\u043B\u043E\u0438" tabindex="-1"><a class="header-anchor" href="#\u0441\u043B\u043E\u0438" aria-hidden="true">#</a> \u0421\u043B\u043E\u0438</h2><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 <code>App</code> \u0445\u0440\u0430\u043D\u0438\u0442 \u0432 \u0441\u0435\u0431\u0435 \u0432 \u0441\u0432\u043E\u0439\u0441\u0442\u0432\u0435 <code>LayersStore</code> \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432. \u0425\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0447\u0442\u0438\u043A\u0438 \u043A \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044E \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C \u043C\u0435\u0442\u043E\u0434\u043E\u0432 <code>AddLayer</code>, <code>Get</code>, <code>Post</code> \u0438 \u0434\u0440. \u0412\u0441\u0435 \u043C\u0435\u0442\u043E\u0434\u044B <code>LayersStore</code> \u0442\u0430\u043A\u0436\u0435 \u043C\u043E\u0436\u043D\u043E \u0432\u044B\u0437\u044B\u0432\u0430\u0442\u044C \u043D\u0430 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0438, \u0435\u0441\u043B\u0438 \u0445\u043E\u0447\u0435\u0442\u0441\u044F \u043F\u0438\u0441\u0430\u0442\u044C \u043B\u0430\u043A\u043E\u043D\u0438\u0447\u043D\u043E.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
    app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="handler-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A" tabindex="-1"><a class="header-anchor" href="#handler-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A" aria-hidden="true">#</a> Handler / \u041E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A</h3><p>\u0424\u0443\u043D\u043A\u0446\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u0432 \u043E\u0431\u0449\u0435\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u043F\u0440\u0438\u043D\u043C\u0430\u0435\u0442 1 \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Handler <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Context</p><p>\u041A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 - \u044D\u0442\u043E \u0441\u0432\u044F\u0437\u0443\u044E\u0449\u0430\u044F \u0447\u0430\u0441\u0442\u044C \u043C\u0435\u0436\u0434\u0443 \u0432\u0441\u0435\u043C\u0438 \u0441\u043B\u043E\u044F\u043C\u0438. \u0411\u0430\u0437\u043E\u0432\u044B\u0439 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 \u0445\u0440\u0430\u043D\u0438\u0442 request, response \u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0434\u043E\u0441\u0442\u0443\u043F \u043A \u0442\u0435\u043A\u0443\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E (Layer) \u0432 runtime.</p></div><p>\u0427\u0442\u043E\u0431\u044B \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0443, \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0437\u0432\u0430\u0442\u044C \u043C\u0435\u0442\u043E\u0434 <code>Next</code> \u043D\u0430 \u043E\u0431\u044A\u0435\u043A\u0442\u0435 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0430:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
      ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">\u0421\u043B\u043E\u0435\u043D\u043D\u044B\u0439 \u043F\u043E\u0434\u0445\u043E\u0434</p><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u0438\u043C\u0435\u0435\u0442 1 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0443\u044E \u0437\u043E\u043D\u0443 \u043E\u0442\u0432\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0441\u0442\u0438, \u044D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0432\u0430\u0448\u0435\u043C\u0443 \u043A\u043E\u0434\u0443 \u043F\u0440\u043E\u0441\u0442\u044B\u043C \u0438 \u0447\u0438\u0441\u0442\u044B\u043C. \u0421\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C\u043E\u0441\u0442\u043E\u044F\u0442\u0435\u043B\u044C\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u0441\u043B\u043E\u0439, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0432\u0435\u0440\u044F\u0435\u0442 \u0430\u0443\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044E, \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0441 \u0441\u0442\u0430\u0442\u0443\u0441 \u043A\u043E\u0434\u043E\u043C <code>401</code>. \u0421 \u0442\u0430\u043A\u0438\u043C \u043F\u043E\u0434\u0445\u043E\u0434\u043E\u043C, \u043C\u044B \u043C\u043E\u0436\u0435\u043C \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0431\u0440\u0430\u0431\u0430\u0442\u044B\u0432\u0430\u0442\u044C \u043D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u044B.</p><p>\u0414\u0440\u0443\u0433\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440, \u044D\u0442\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043C\u043E\u0436\u0435\u0442 \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043F\u0440\u043E\u0441 \u0438 \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0442\u0432\u0435\u0447\u0430\u0442\u044C \u043D\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0438\u0437 \u043A\u0435\u0448\u0430.</p></div><h3 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> Options</h3><p>\u041E\u043F\u0446\u0438\u0438 \u043E\u0431\u044A\u0435\u043A\u0442\u0430 Layer</p><table><thead><tr><th>\u041E\u043F\u0446\u0438\u044F</th><th>\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435</th><th>\u041F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E</th><th>\u041F\u0440\u0438\u043C\u0435\u0440 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F</th></tr></thead><tbody><tr><td><strong>Path</strong></td><td>\u043E\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u0442 uri \u043F\u0443\u0442\u044C, \u043D\u0430 \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0434\u043E\u043B\u0436\u0435\u043D \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F \u0441\u043B\u043E\u0439, \u043C\u043E\u0436\u0440\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043B\u043E\u0432\u0430\u0442\u044C \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043A\u0438, \u0431\u0435\u0437 \u0443\u043A\u0430\u0437\u0430\u0440\u0438\u044F \u044D\u0442\u043E\u0433\u043E \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0430 \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 uri</td><td>-</td><td><code>/users/{id}/</code></td></tr><tr><td><strong>Name</strong></td><td>\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u043C \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u043E\u0435 \u0438\u043C\u044F \u0441\u043B\u043E\u044F, \u0447\u0435\u0440\u0435\u0437 \u044D\u0442\u043E \u0438\u043C\u044F \u043C\u043E\u0436\u043D\u043E \u0431\u0443\u0434\u0435\u0442 \u043D\u0430\u0439\u0442\u0438 \u0441\u043B\u043E\u0439 (\u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E \u0432\u0441\u0435 \u0441\u043B\u043E\u0438 \u043F\u043E\u043B\u0443\u0447\u0430\u044E\u0442 \u0438\u043C\u0435\u043D\u0430 \u0432\u0438\u0434\u0430 <code>l-0</code>, <code>l-1</code>, <code>l-2</code>, \u0438 \u0442.\u0434.)</td><td>-</td><td><code>usersAction</code></td></tr><tr><td><strong>Methods</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0438\u0437 http \u043C\u0435\u0442\u043E\u0434\u043E\u0432, \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0442\u043E\u043B\u044C\u043A\u043E \u043D\u0430 http \u0437\u0430\u043F\u0440\u043E\u0441\u044B \u0441 \u0443\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u043C\u0438 http \u043C\u0435\u0442\u043E\u0434\u0430\u043C\u0438. \u0415\u0441\u043B\u0438 \u043C\u0435\u0442\u043E\u0434\u044B \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u043D\u044B, \u0442\u043E \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 http \u043C\u0435\u0442\u043E\u0434</td><td><code>[]</code></td><td><code>[&#39;GET&#39;]</code></td></tr><tr><td><strong>Priority</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 <code>int</code> \u0447\u0438\u0441\u043B\u043E \u0441 \u043F\u0440\u0438\u043E\u0440\u0438\u0442\u0435\u0442\u043E\u043C, \u0447\u0435\u043C \u043D\u0438 \u043C\u0435\u043D\u044C\u0448\u0435 \u0447\u0438\u0441\u043B\u043E, \u0442\u0435\u043C \u0440\u0430\u043D\u044C\u0448\u0435 \u0432\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u0441\u044F \u0441\u043B\u043E\u0439. \u042D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043B\u043E\u0438 \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0435 \u0432 \u043F\u043E\u0440\u044F\u0434\u043A\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F</td><td><code>50</code></td><td><code>100</code></td></tr><tr><td><strong>Restrictions</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0432\u0438\u0434\u0430 [&#39;id&#39; =&gt; \\id+], \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044F \u043D\u0430\u043A\u043B\u0430\u0434\u044B\u0432\u0430\u0442\u044C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043D\u0430 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B \u0432 uri \u0437\u0430\u043F\u0440\u043E\u0441\u0430</td><td><code>[]</code></td><td><code>[&#39;id&#39;=&gt;&#39;\\d+&#39;]</code></td></tr><tr><td><strong>Context</strong></td><td>\u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u043A \u0441\u043B\u043E\u044E \u043B\u044E\u0431\u044B\u0435 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u043B\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435</td><td><code>[]</code></td><td><code>[&#39;foo&#39;=&gt;&#39;bar&#39;]</code></td></tr></tbody></table><p>\u041F\u0440\u0438\u043C\u0435\u0440 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F options \u0432 \u043A\u043E\u0434\u0435:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	handler <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		name<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">UriParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello \`</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		<span class="token string">\`Path\`</span><span class="token punctuation">:</span>     <span class="token string">\`/hello/{name}/\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Name\`</span><span class="token punctuation">:</span>     <span class="token string">\`HelloAction\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Methods\`</span><span class="token punctuation">:</span>  <span class="token string">\`GET|POST\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Priority\`</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		<span class="token string">\`Restrictions\`</span><span class="token punctuation">:</span> next<span class="token punctuation">.</span>Restrictions<span class="token punctuation">{</span>
			<span class="token string">\`name\`</span><span class="token punctuation">:</span> <span class="token string">\`[a-z]+\`</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> app<span class="token punctuation">.</span>FasthttpHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440" tabindex="-1"><a class="header-anchor" href="#\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440" aria-hidden="true">#</a> \u0411\u044B\u0441\u0442\u0440\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B (\u0441\u0430\u0445\u0430\u0440)</h3><p>\u0414\u043B\u044F \u0443\u043F\u0440\u043E\u0449\u0435\u043D\u0438\u044F \u0442\u0430\u043A\u0436\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B \u043C\u0435\u0442\u043E\u0434\u044B, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0435\u0440\u043A\u0430\u043B\u0438\u0440\u0443\u044E\u0442 \u043E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

handler <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span>
	<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Patch</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F" tabindex="-1"><a class="header-anchor" href="#\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F" aria-hidden="true">#</a> \u0414\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F \u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F</h3><p>\u041E\u0447\u0435\u043D\u044C \u0443\u0434\u043E\u0431\u043D\u043E \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043C\u0430\u0440\u0448\u0440\u0443\u0442\u044B \u0438 \u043F\u043E\u0440\u044F\u0434\u043E\u043A \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C yml \u0444\u0430\u0439\u043B\u043E\u0432, \u043F\u0440\u043E\u0441\u0442\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440 \u0442\u0430\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043C\u043E\u0436\u0435\u0442 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442\u044C \u0442\u0430\u043A:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># middlewares</span>
<span class="token key atrule">ThrowableToResponse</span><span class="token punctuation">:</span>
  <span class="token key atrule">controller</span><span class="token punctuation">:</span> xxx

<span class="token comment"># 404 page</span>
<span class="token key atrule">otherwise</span><span class="token punctuation">:</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> xxx
  <span class="token key atrule">name</span><span class="token punctuation">:</span> otherwise
  <span class="token key atrule">priority</span><span class="token punctuation">:</span> <span class="token number">10000</span>

<span class="token comment"># actions</span>
<span class="token key atrule">main</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> xxx

<span class="token key atrule">posts</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /post/
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> xxx

<span class="token key atrule">cat</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /cat/<span class="token punctuation">{</span>id<span class="token punctuation">}</span>/
  <span class="token key atrule">restrictions</span><span class="token punctuation">:</span>
    <span class="token key atrule">id</span><span class="token punctuation">:</span> \\d+
  <span class="token key atrule">methods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;GET&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">handler</span><span class="token punctuation">:</span> xxx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u041C\u0438\u043A\u0440\u043E\u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u0442 \u043D\u0435 \u043F\u043E\u0441\u0442\u0430\u043B\u0432\u044F\u0434\u0435\u0442 \u0444\u0430\u0431\u0440\u0438\u043A\u0443 \u0441\u043B\u043E\u0435\u0432, \u0447\u0442\u043E\u0431\u044B \u043D\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0438\u0432\u0430\u0442\u044C \u0441\u0438\u043D\u0442\u0430\u043A\u0441\u0438\u0441 \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438. \u041D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u0442\u0430\u043A\u0443\u044E \u0444\u0430\u0431\u0440\u0438\u043A\u0443 \u044D\u0442\u043E \u0442\u0440\u0438\u0432\u0438\u0430\u043B\u044C\u043D\u0430\u044F \u0437\u0430\u0434\u0430\u0447\u0430, \u043F\u0440\u0438\u043C\u0435\u0440:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> examples

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;log&quot;</span>
	<span class="token string">&quot;os&quot;</span>
	<span class="token string">&quot;strings&quot;</span>

	<span class="token string">&quot;gopkg.in/yaml.v3&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> RouterConfig <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Path         <span class="token builtin">string</span>
	Methods      <span class="token builtin">string</span>
	Controller   <span class="token builtin">string</span>
	Name         <span class="token builtin">string</span>
	Priority     <span class="token builtin">int</span>
	Handler      next<span class="token punctuation">.</span>Handler
	Restrictions next<span class="token punctuation">.</span>Restrictions
<span class="token punctuation">}</span>

<span class="token keyword">var</span> HandlerMap <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>next<span class="token punctuation">.</span>Handler<span class="token punctuation">{</span>
	<span class="token string">&quot;otherwise&quot;</span><span class="token punctuation">:</span> MainPageAppHandler2<span class="token punctuation">,</span>
	<span class="token string">&quot;mainPage&quot;</span><span class="token punctuation">:</span>  MainPageAppHandler2<span class="token punctuation">,</span>
	<span class="token string">&quot;mainPage2&quot;</span><span class="token punctuation">:</span> MainPageAppHandler2<span class="token punctuation">,</span>
	<span class="token string">&quot;hello&quot;</span><span class="token punctuation">:</span>     MainPageAppHandler2<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">CreateLayers</span><span class="token punctuation">(</span>projectDir <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>next<span class="token punctuation">.</span>Layer <span class="token punctuation">{</span>
	rawData<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span>projectDir <span class="token operator">+</span> <span class="token string">&quot;/config/router.yml&quot;</span><span class="token punctuation">)</span>

	<span class="token keyword">var</span> routes <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>RouterConfig
	err <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>rawData<span class="token punctuation">,</span> <span class="token operator">&amp;</span>routes<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;error: %v&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> <span class="token function">factoryLayers</span><span class="token punctuation">(</span>routes<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">factoryLayers</span><span class="token punctuation">(</span>routes <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span>RouterConfig<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>next<span class="token punctuation">.</span>Layer <span class="token punctuation">{</span>
	<span class="token keyword">var</span> layers <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>next<span class="token punctuation">.</span>Layer
	<span class="token keyword">var</span> methods <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>

	<span class="token keyword">for</span> name<span class="token punctuation">,</span> route <span class="token operator">:=</span> <span class="token keyword">range</span> routes <span class="token punctuation">{</span>
		handler <span class="token operator">:=</span> HandlerMap<span class="token punctuation">[</span>route<span class="token punctuation">.</span>Controller<span class="token punctuation">]</span>
		<span class="token keyword">if</span> route<span class="token punctuation">.</span>Name <span class="token operator">==</span> <span class="token string">\`\`</span> <span class="token punctuation">{</span>
			route<span class="token punctuation">.</span>Name <span class="token operator">=</span> name
		<span class="token punctuation">}</span>

		<span class="token keyword">if</span> route<span class="token punctuation">.</span>Methods <span class="token operator">!=</span> <span class="token string">\`\`</span> <span class="token punctuation">{</span>
			methods <span class="token operator">=</span> strings<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>Methods<span class="token punctuation">,</span> <span class="token string">\`|\`</span><span class="token punctuation">)</span> <span class="token comment">// GET|POST|PUT</span>
		<span class="token punctuation">}</span>

		layer <span class="token operator">:=</span> next<span class="token punctuation">.</span>Layer<span class="token punctuation">{</span>
			Handlers<span class="token punctuation">:</span>     <span class="token punctuation">[</span><span class="token punctuation">]</span>next<span class="token punctuation">.</span>Handler<span class="token punctuation">{</span>handler<span class="token punctuation">}</span><span class="token punctuation">,</span>
			Priority<span class="token punctuation">:</span>     route<span class="token punctuation">.</span>Priority<span class="token punctuation">,</span>
			Name<span class="token punctuation">:</span>         route<span class="token punctuation">.</span>Name<span class="token punctuation">,</span>
			Path<span class="token punctuation">:</span>         route<span class="token punctuation">.</span>Path<span class="token punctuation">,</span>
			Restrictions<span class="token punctuation">:</span> route<span class="token punctuation">.</span>Restrictions<span class="token punctuation">,</span>
			Methods<span class="token punctuation">:</span>      methods<span class="token punctuation">,</span>
		<span class="token punctuation">}</span>

		layers <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>layers<span class="token punctuation">,</span> <span class="token operator">&amp;</span>layer<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">return</span> layers
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">MainPageAppHandler2</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`MainPageAppHandler2\`</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="inline-\u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F-\u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432-\u0432-uri" tabindex="-1"><a class="header-anchor" href="#inline-\u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F-\u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432-\u0432-uri" aria-hidden="true">#</a> Inline \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432 \u0432 uri</h3><p>\u041E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043D\u0430 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440 \u0432 <code>Path</code> \u043C\u043E\u0436\u043D\u043E \u043E\u043F\u0438\u0441\u0430\u0442\u044C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u043F\u0440\u044F\u043C\u043E \u0432 <code>Path</code> \u043F\u043E\u043C\u0438\u043C\u043E \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u043E\u043F\u0446\u0438\u0438 <code>Restrictions</code> \u0443 \u0441\u043B\u043E\u044F. Inline \u0444\u043E\u0440\u043C\u0430\u0442 \u0437\u0430\u043F\u0438\u0441\u0438 \u043F\u0440\u043E\u0449\u0435 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u0442\u044B\u0445 \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043E\u043A. \u0414\u043B\u044F \u0441\u043B\u043E\u0436\u043D\u044B\u0445 \u0438 \u0434\u043B\u0438\u043D\u043D\u044B\u0445 \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043E\u043A \u043B\u0443\u0447\u0448\u0435 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u044C \u044F\u0432\u043D\u043E \u043E\u043F\u0446\u0438\u044E <code>Restrictions</code>, \u0447\u0442\u043E\u0431\u044B \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F \u0441\u043B\u043E\u044F \u043E\u0441\u0442\u0430\u0432\u0430\u043B\u0430\u0441\u044C \u043F\u0440\u043E\u0441\u0442\u043E\u0439 \u0434\u043B\u044F \u0447\u0442\u0435\u043D\u0438\u044F \u0438 \u0438\u043D\u0442\u0435\u0440\u043F\u0440\u0438\u0442\u0430\u0446\u0438\u0438. \u0412 \u043E\u0431\u0449\u0435\u043C \u0432\u0438\u0434\u0435 \u0442\u0430\u043A\u0430\u044F \u0444\u043E\u0440\u043C\u0430 \u0437\u0430\u043F\u0438\u0441\u0438 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A <code>{name:restrictRegExp}</code>. \u0421\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0435 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u044D\u043A\u0432\u0438\u0432\u0430\u043B\u0435\u043D\u0442\u043D\u044B:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">cat</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /cat/<span class="token punctuation">{</span>id<span class="token punctuation">}</span>/
  <span class="token key atrule">restrictions</span><span class="token punctuation">:</span>
    <span class="token key atrule">id</span><span class="token punctuation">:</span> \\d+

<span class="token key atrule">cat2</span><span class="token punctuation">:</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /cat/<span class="token punctuation">{</span>id<span class="token punctuation">:</span>\\d+<span class="token punctuation">}</span>/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">\u041F\u0440\u0438\u043E\u0440\u0438\u0442\u0435\u0442</p><p>Inline \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u0431\u0443\u0434\u0443\u0442 \u043F\u0440\u043E\u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u044B, \u0435\u0441\u043B\u0438 \u044D\u0442\u043E\u0442 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440 \u0441\u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u043D \u0447\u0435\u0440\u0435\u0437 \u043E\u043F\u0446\u0438\u044E <code>Restrictions</code></p></div><h3 id="flow" tabindex="-1"><a class="header-anchor" href="#flow" aria-hidden="true">#</a> Flow</h3><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u0434\u043E \u0432\u044B\u0437\u043E\u0432\u0430 <code>ctx-&gt;Next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u0442\u0430\u043A\u0436\u0435 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u043F\u043E\u0441\u043B\u0435 \u0432\u044B\u0437\u043E\u0432\u0430 <code>ctx-&gt;Next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u043E\u0442\u0432\u0435\u0442\u0430. \u041F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u043B\u043D\u043E\u0433\u043E \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0445\u043E\u0434\u0438\u0442 \u0441\u043A\u0432\u043E\u0437\u044C \u0432\u0441\u0435 \u0441\u043B\u043E\u0438:</p><p><img src="`+i+'" alt="200 flow"></p><p>\u041F\u0440\u0438\u043C\u0435\u0440 flow, \u043A\u043E\u0433\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0434\u043E\u0441\u0440\u043E\u0447\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u043D \u043E\u0434\u043D\u0438\u043C \u0438\u0437 \u0441\u043B\u043E\u0435\u0432, \u0431\u0435\u0437 \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0447\u0435\u0440\u0435\u0437 <code>ctx-&gt;Next()</code>:</p><p><img src="'+l+'" alt="401 flow"></p>',46),E=p(`<p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u0440\u0435\u0448\u0430\u0435\u0442 \u0441\u0430\u043C, \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043F\u0440\u0435\u043A\u0442\u0430\u0442\u0438\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443, \u043B\u0438\u0431\u043E \u0432\u044B\u0437\u0432\u0430\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0441\u043B\u043E\u0439 \u0438 \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0435\u043C\u0443 \u0442\u0435\u043C \u0441\u0430\u043C\u044B\u043C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443.</p><h2 id="fasthttp" tabindex="-1"><a class="header-anchor" href="#fasthttp" aria-hidden="true">#</a> Fasthttp</h2><h3 id="\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F" tabindex="-1"><a class="header-anchor" href="#\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F" aria-hidden="true">#</a> \u0418\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F</h3><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u0443\u0435\u0442 \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0430 <code>fasthttp.RequestCtx</code>. \u0417\u0430 \u0441\u0447\u0435\u0442 \u044D\u0442\u043E\u0433\u043E \u043E\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0438\u043D\u0442\u0435\u0433\u0440\u0438\u0440\u043E\u0432\u0442\u044C\u0441\u044F \u0432 \u043B\u044E\u0431\u044B\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F fasthttp \u043A\u0430\u043A middleware, \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044F \u043D\u0430 \u0432\u0445\u043E\u0434 <code>fasthttp.RequestCtx</code>.</p><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>fasthttp</code> -&gt; <code>fasthttp</code> -&gt; <code>next</code>.</p><hr><p>\u0415\u0441\u043B\u0438 \u043C\u0438\u043A\u0440\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0434\u0430\u043B\u0435\u0435 \u0432 \u043A\u043B\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043A\u043E\u0435 <code>fasthttp</code> \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435, \u0442\u043E \u043C\u043E\u0436\u043D\u043E \u043E\u0431\u0435\u0440\u043D\u0443\u0442\u044C \u0432 \u0442\u0430\u043A\u0443\u044E middleware:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	next2 <span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">appToFasthttpMiddleware</span><span class="token punctuation">(</span>app next2<span class="token punctuation">.</span>App<span class="token punctuation">,</span> handler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next2<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next2<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">handler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token keyword">return</span> app<span class="token punctuation">.</span>FasthttpHandler
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler1</span><span class="token punctuation">(</span>requestHandler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-1-\`</span><span class="token punctuation">)</span>
		<span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler2</span><span class="token punctuation">(</span>requestHandler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-2-\`</span><span class="token punctuation">)</span>
		<span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler3</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-3-\`</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next2<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next2<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next2<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`next-1-\`</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	afterHandler <span class="token operator">:=</span> <span class="token function">handler2</span><span class="token punctuation">(</span>handler3<span class="token punctuation">)</span>
	appHandler <span class="token operator">:=</span> <span class="token function">appToFasthttpMiddleware</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> afterHandler<span class="token punctuation">)</span> <span class="token comment">// app as middleware of fasthttp + delegate to next handler</span>
	allHandler <span class="token operator">:=</span> <span class="token function">handler1</span><span class="token punctuation">(</span>appHandler<span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> allHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>fasthttp (handler1)</code> -&gt; <code>next</code> -&gt; <code>fasthttp (handler2)</code> -&gt; <code>fasthttp (handler 3)</code>.</p><p>\u0422\u0430\u043A\u0438\u0435 \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044E\u0442 \u0442\u043E\u0447\u0435\u0447\u043D\u043E \u0437\u0430\u043C\u0435\u043D\u044F\u0442\u044C \u0447\u0430\u0441\u0442\u0438 \u0441\u0442\u0430\u0440\u043E\u0433\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u0438\u043B\u0438 \u043F\u0435\u0440\u0435\u043D\u043E\u0441\u0438\u0442\u044C \u043D\u0435\u0431\u043E\u043B\u044C\u0448\u0438\u043C\u0438 \u043A\u0443\u0441\u043E\u0447\u043A\u0430\u043C\u0438 \u0447\u0430\u0441\u0442\u044C \u0444\u0443\u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u0430.</p><h2 id="net-http" tabindex="-1"><a class="header-anchor" href="#net-http" aria-hidden="true">#</a> net.http</h2><h3 id="\u0430\u0434\u0430\u043F\u0442\u0435\u0440" tabindex="-1"><a class="header-anchor" href="#\u0430\u0434\u0430\u043F\u0442\u0435\u0440" aria-hidden="true">#</a> \u0410\u0434\u0430\u043F\u0442\u0435\u0440</h3>`,12),G=s("\u041C\u043E\u0436\u043D\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u0432\u0430\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0438 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435 "),I={href:"https://pkg.go.dev/net/http#HandlerFunc",target:"_blank",rel:"noopener noreferrer"},D=s("http.HandleFunc"),V=s(" \u0447\u0435\u0440\u0435\u0437 \u0430\u0434\u0430\u043F\u0442\u0435\u0440 "),O=n("code",null,"next.FromHttpHandlerFunc",-1),W=p(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;net/http&quot;</span>

	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">netHttpHandlerFunc</span><span class="token punctuation">(</span>w http<span class="token punctuation">.</span>ResponseWriter<span class="token punctuation">,</span> request <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> w<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestURI<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	wrapHandler <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">FromHttpHandlerFunc</span><span class="token punctuation">(</span>netHttpHandlerFunc<span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> wrapHandler<span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> app<span class="token punctuation">.</span>FasthttpHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function j(z,J){const t=c("router-link"),o=c("ExternalLinkIcon");return r(),d("div",null,[b,n("nav",m,[n("ul",null,[n("li",null,[a(t,{to:"#hello-world"},{default:e(()=>[h]),_:1})]),n("li",null,[a(t,{to:"#\u0433\u043B\u043E\u0441\u0441\u0430\u0440\u0438\u0438"},{default:e(()=>[g]),_:1})]),n("li",null,[a(t,{to:"#\u0441\u043B\u043E\u0438"},{default:e(()=>[f]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#handler-\u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A"},{default:e(()=>[x]),_:1})]),n("li",null,[a(t,{to:"#options"},{default:e(()=>[y]),_:1})]),n("li",null,[a(t,{to:"#\u0431\u044B\u0441\u0442\u0440\u044B\u0435-http-\u043C\u0435\u0442\u043E\u0434\u044B-\u0441\u0430\u0445\u0430\u0440"},{default:e(()=>[_]),_:1})]),n("li",null,[a(t,{to:"#\u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u0430\u044F-\u043A\u043E\u0444\u043D\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044F"},{default:e(()=>[w]),_:1})]),n("li",null,[a(t,{to:"#inline-\u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F-\u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432-\u0432-uri"},{default:e(()=>[q]),_:1})]),n("li",null,[a(t,{to:"#flow"},{default:e(()=>[H]),_:1})])])]),n("li",null,[a(t,{to:"#fasthttp"},{default:e(()=>[R]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#\u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044F"},{default:e(()=>[A]),_:1})])])]),n("li",null,[a(t,{to:"#net-http"},{default:e(()=>[C]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#\u0430\u0434\u0430\u043F\u0442\u0435\u0440"},{default:e(()=>[P]),_:1})])])])])]),N,n("div",L,[S,n("p",null,[F,n("a",M,[T,a(o)]),B])]),U,k(`
\`\`\`yml
@startuml
scale 1.3
title: 401 response

Client -> App: http request
    activate App
    App -> "Auth Layer": request
    
        activate "Auth Layer"
        "Auth Layer" -> App: 401 response
        deactivate "Auth Layer"
    
    App -> Client: http response
    deactivate App
@enduml
\`\`\`
`),E,n("p",null,[G,n("a",I,[D,a(o)]),V,O]),W])}const X=u(v,[["render",j],["__file","index.html.vue"]]);export{X as default};
