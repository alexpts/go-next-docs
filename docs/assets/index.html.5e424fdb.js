import{_ as i,a as l}from"./401.09c2255f.js";import{_ as u,r as p,o as d,c as r,a as n,d as a,w as e,e as k,b as s,f as o}from"./app.f2fd8a86.js";const v={},h=n("h1",{id:"quick-start",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#quick-start","aria-hidden":"true"},"#"),s(" Quick Start")],-1),b={class:"table-of-contents"},m=s("Hello World"),g=s("Glossary"),f=s("Layers Store"),x=s("Handler"),y=s("Options"),_=s("Fast http methods"),w=s("Declarative configuration"),q=s("Flow"),H=s("Fasthttp"),A=s("Integration"),C=n("hr",null,null,-1),R={class:"custom-container tip"},S=n("p",{class:"custom-container-title"},"\u041F\u0440\u0435\u0434\u044B\u0441\u0442\u043E\u0440\u0438\u044F",-1),L=s("Next \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E\u0439 \u0432\u0435\u0440\u0441\u0438\u0435\u0439 \u043C\u0438\u043A\u0440\u043E\u0444\u0440\u0435\u0439\u043C\u0432\u043E\u0440\u043A\u0430 "),N={href:"https://github.com/alexpts/php-next2",target:"_blank",rel:"noopener noreferrer"},F=s("php-next2"),B=s("."),P=o(`<h2 id="hello-world" tabindex="-1"><a class="header-anchor" href="#hello-world" aria-hidden="true">#</a> Hello World</h2><p>\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u043E\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> app<span class="token punctuation">.</span>FasthttpHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="glossary" tabindex="-1"><a class="header-anchor" href="#glossary" aria-hidden="true">#</a> Glossary</h2><h4 id="middleware" tabindex="-1"><a class="header-anchor" href="#middleware" aria-hidden="true">#</a> Middleware</h4><p>Middleware - \u044D\u0442\u043E \u0447\u0430\u0441\u0442\u044C \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F, \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u043E\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043A\u043E\u043D\u043A\u0440\u0435\u0442\u043D\u0443\u044E \u0435\u0434\u0438\u043D\u0438\u0446\u0443 \u043B\u043E\u0433\u0438\u043A\u0438 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 request/response.</p><h4 id="layer" tabindex="-1"><a class="header-anchor" href="#layer" aria-hidden="true">#</a> Layer</h4><p>\u042D\u0442\u043E \u0430\u0431\u0441\u0442\u0440\u0430\u043A\u0446\u0438\u044F \u043A\u043E\u0442\u043E\u0440\u0430\u044F \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043F\u043E \u0441\u0443\u0442\u0438 middleware. Layer \u043C\u043E\u0436\u0435\u0442 \u0438\u043C\u0435\u0442\u044C \u043A\u0430\u043A 1 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u0442\u0430\u043A \u0438 \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E, \u0447\u0442\u043E\u0431\u044B \u0434\u0435\u043A\u043E\u043C\u043F\u043E\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043D\u0430 \u0431\u043E\u043B\u0435\u0435 \u043C\u0435\u043B\u043A\u0438\u0435 \u0447\u0430\u0441\u0442\u0438 \u043A\u043E\u0434.</p><h4 id="application" tabindex="-1"><a class="header-anchor" href="#application" aria-hidden="true">#</a> Application</h4><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u0441\u0430\u043C\u044B\u043C \u0432\u044B\u0441\u043E\u043A\u0438\u043C \u0443\u0440\u043E\u0432\u043D\u0435\u043C \u0438 \u0440\u0435\u0430\u043B\u0437\u0438\u0443\u0435\u0442 \u043F\u043E\u043B\u043D\u043E\u0443\u044E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430. \u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u044D\u0442\u043E \u043D\u0430\u0431\u043E\u0440 Layers, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0434\u043B\u044F \u043A\u0430\u0436\u0434\u043E\u0433\u043E http \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0438\u043D\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043B\u044C\u043D\u043E. \u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u043D\u0430 \u0432\u0445\u043E\u0434\u0435 http request \u0438 \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response.</p><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u043E\u0441\u043E\u0437\u043D\u0430\u043D\u043E \u0441\u0432\u043E\u0434\u0438\u0442 \u0447\u0438\u0441\u043B\u043E \u0441\u0443\u0449\u043D\u043E\u0441\u0442\u0435\u0439 \u043A \u043C\u0438\u043D\u0438\u043C\u0443\u043C\u0443, \u0447\u0442\u043E\u0431\u044B \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u043F\u0440\u043E\u0441\u0442\u044B\u043C, \u043F\u043E\u043D\u044F\u0442\u043D\u044B\u043C \u0438 \u043D\u0430\u0434\u0435\u0436\u043D\u044B\u043C. \u041E\u0441\u043D\u043E\u0432\u043D\u043E\u0435 \u043F\u043E\u043D\u044F\u0442\u0438\u0435 \u0441 \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u043F\u0440\u0438\u0434\u0435\u0442\u0441\u044F \u043F\u043E\u0441\u0442\u043E\u044F\u043D\u043D\u043E \u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u044D\u0442\u043E Layer (\u0421\u043B\u043E\u0439).</p><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u0438\u043D\u0435 \u043F\u043E\u043B\u0443\u0447\u0430\u0435\u0442 \u043D\u0430 \u0432\u0445\u043E\u0434 \u043E\u0431\u044A\u0435\u043A\u0442 <code>fasthttp.RequestCtx</code> \u0438 \u043F\u0440\u043E\u0433\u043E\u043D\u044F\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 \u0432\u0441\u0435 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0438 \u0441\u043B\u043E\u0435\u0432. \u041A\u0430\u043A\u0438\u0435 \u0438\u043C\u0435\u043D\u043D\u043E \u0441\u043B\u043E\u0438 \u043F\u0440\u0438\u043C\u0443\u0442 \u0447\u0430\u0441\u0442\u0438\u0435 \u0432 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0435\u0442\u0430\u0438\u0444\u043D\u043E\u0440\u043C\u0430\u0446\u0438\u0435\u0439 \u0441\u043B\u043E\u044F. \u0421\u0435\u043C\u0430\u043D\u0442\u0438\u0447\u0435\u0441\u043A\u0438 \u043C\u043E\u0436\u043D\u043E \u0432\u044B\u0434\u0435\u043B\u0438\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0435 \u0442\u0438\u043F\u044B \u0441\u043B\u043E\u0435\u0432:</p><ul><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u043C \u0437\u0430\u043F\u0440\u043E\u0441\u0435</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443</li><li>\u0410\u043A\u0442\u0438\u0432\u0430\u0446\u0438\u044F \u043F\u043E \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044E uri \u0432 \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u043E\u043C \u0432\u044B\u0440\u0430\u0436\u0435\u043D\u0438\u0438</li><li>\u0410\u043A\u0442\u0438\u0447\u0430\u0446\u0438\u044F \u043F\u043E \u043A\u0430\u0441\u0442\u043E\u043C\u043D\u043E\u0439 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438</li></ul><details class="custom-container details"><summary>\u0421\u043E\u0431\u0441\u0442\u0432\u0435\u043D\u043D\u044B\u0435 \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u0438</summary><p>\u0418\u0437 \u043A\u043E\u0440\u043E\u0431\u043A\u0438 \u0438\u0434\u0435\u0442 \u043C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \u0441\u0442\u0440\u0430\u0442\u0435\u043D\u0438\u0439 (\u043F\u043E http \u043C\u0435\u0442\u043E\u0434\u0443 \u0438 \u043F\u043E\u0438\u0441\u043A \u043F\u043E uri). \u041C\u043E\u0436\u043D\u043E \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u0442\u044C \u043B\u044E\u0431\u044B\u0435 \u043A\u0430\u0441\u0442\u043E\u043C\u043D\u044B\u0435 \u043F\u0440\u0430\u0432\u0438\u043B\u0430, \u043F\u043E \u043A\u043E\u0442\u043E\u0440\u044B\u043C \u0431\u0443\u0434\u0435\u0442 \u043F\u0440\u0438\u043D\u044F\u0442\u043E \u0440\u0435\u0448\u0435\u043D\u0438\u0435 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043B\u0438 \u0441\u043B\u043E\u044F \u0434\u043B\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0438\u043B\u0438 \u043D\u0435\u0442. \u0414\u043B\u044F \u044D\u0442\u043E\u0433\u043E \u043D\u0443\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0432\u043E\u044E \u0440\u0435\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044E <code>next.ResolverContract</code></p></details><h2 id="layers-store" tabindex="-1"><a class="header-anchor" href="#layers-store" aria-hidden="true">#</a> Layers Store</h2><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 <code>MicroApp</code> \u0445\u0440\u0430\u043D\u0438\u0442 \u0432 \u0441\u0435\u0431\u0435 \u0432 \u0441\u0432\u043E\u0439\u0441\u0442\u0432\u0435 <code>LayersStore</code> \u0445\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432. \u0425\u0440\u0430\u043D\u0438\u043B\u0438\u0449\u0435 \u0441\u043B\u043E\u0435\u0432 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0447\u0442\u0438\u043A\u0438 \u043A \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044E \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C \u043C\u0435\u0442\u043E\u0434\u043E\u0432 <code>Use</code>, <code>AddLayer</code>, <code>Get</code>, <code>Post</code> \u0438 \u0434\u0440 :</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    app <span class="token operator">:=</span> <span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
    app<span class="token punctuation">.</span>LayersStore<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>layer<span class="token punctuation">.</span>Ctx<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>FCtx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="handler" tabindex="-1"><a class="header-anchor" href="#handler" aria-hidden="true">#</a> Handler</h3><p>\u0424\u0443\u043D\u043A\u0446\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A \u0432 \u043E\u0431\u0449\u0435\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u043F\u0440\u0438\u043D\u043C\u0430\u0435\u0442 1 \u0430\u0440\u0433\u0443\u043C\u0435\u043D\u0442.</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Handler <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>layer<span class="token punctuation">.</span>Ctx<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Context</p><p>\u041A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 - \u044D\u0442\u043E \u0441\u0432\u044F\u0437\u0443\u044E\u0449\u0430\u044F \u0447\u0430\u0441\u0442\u044C \u043C\u0435\u0436\u0434\u0443 \u0432\u0441\u0435\u043C\u0438 \u0441\u043B\u043E\u044F\u043C\u0438. \u0411\u0430\u0437\u043E\u0432\u044B\u0439 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 \u0445\u0440\u0430\u043D\u0438\u0442 request, response \u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u043E\u043B\u0443\u0447\u0438\u0442\u044C \u0434\u043E\u0441\u0442\u0443\u043F \u043A \u0442\u0435\u043A\u0443\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E (Layer) \u0432 runtime. \u0412 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0435 \u043C\u043E\u0436\u043D\u043E \u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0432\u0441\u0435 \u0447\u0442\u043E \u0443\u0433\u043E\u0434\u043D\u043E, <s>\u0440\u0430\u0441\u0448\u0438\u0440\u044F\u044F \u0435\u0433\u043E \u0434\u043E\u0447\u0435\u0440\u043D\u0438\u043C \u043A\u043B\u0430\u0441\u0441\u043E\u043C \u0438 \u043D\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0438\u0432\u0430\u044F \u0441\u0435\u0431\u044F</s>.</p></div><p>\u0427\u0442\u043E\u0431\u044B \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0443, \u043D\u0443\u0436\u043D\u043E \u0432\u044B\u0437\u0432\u0430\u0442\u044C \u043C\u0435\u0442\u043E\u0434 <code>Next</code> \u043D\u0430 \u043E\u0431\u044A\u0435\u043A\u0442\u0435 \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442\u0430:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>    app <span class="token operator">:=</span> <span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    app<span class="token punctuation">.</span>LayersStore<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>layer<span class="token punctuation">.</span>Ctx<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>FCtx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello\`</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">\u0421\u043B\u043E\u0435\u043D\u043D\u044B\u0439 \u043F\u043E\u0434\u0445\u043E\u0434</p><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u0438\u043C\u0435\u0435\u0442 1 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0443\u044E \u0437\u043E\u043D\u0443 \u043E\u0442\u0432\u0435\u0441\u0442\u0432\u0435\u043D\u043D\u043E\u0441\u0442\u0438, \u044D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043E\u0441\u0442\u0430\u0432\u0430\u0442\u044C\u0441\u044F \u0432\u0430\u0448\u0435\u043C\u0443 \u043A\u043E\u0434\u0443 \u043F\u0440\u043E\u0441\u0442\u044B\u043C \u0438 \u0447\u0438\u0441\u0442\u044B\u043C. \u0421\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C\u043E\u0441\u0442\u043E\u044F\u0442\u0435\u043B\u044C\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044C \u0443\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u0441\u043B\u043E\u044E. \u041D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u0441\u043B\u043E\u0439, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0432\u0435\u0440\u044F\u0435\u0442 \u0430\u0443\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044E, \u043C\u043E\u0436\u0435\u0442 \u0441\u0430\u043C \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0441 \u0441\u0442\u0430\u0442\u0443\u0441 \u043A\u043E\u0434\u043E\u043C <code>401</code>. \u0421 \u0442\u0430\u043A\u0438\u043C \u043F\u043E\u0434\u0445\u043E\u0434\u043E\u043C, \u043C\u044B \u043C\u043E\u0436\u0435\u043C \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0431\u0440\u0430\u0431\u0430\u0442\u044B\u0432\u0430\u0442\u044C \u043D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u044B.</p><p>\u0414\u0440\u0443\u0433\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440, \u044D\u0442\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043C\u043E\u0436\u0435\u0442 \u043A\u0435\u0448\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0437\u0430\u043F\u0440\u043E\u0441 \u0438 \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043E\u0447\u0435\u043D\u044C \u0431\u044B\u0441\u0442\u0440\u043E \u043E\u0442\u0432\u0435\u0447\u0430\u0442\u044C \u043D\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0438\u0437 \u043A\u0435\u0448\u0430.</p></div><h3 id="options" tabindex="-1"><a class="header-anchor" href="#options" aria-hidden="true">#</a> Options</h3><p>\u041E\u043F\u0446\u0438\u0438 \u043E\u0431\u044A\u0435\u043A\u0442\u0430 Layer</p><table><thead><tr><th>\u041E\u043F\u0446\u0438\u044F</th><th>\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435</th><th>\u041F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E</th><th>\u041F\u0440\u0438\u043C\u0435\u0440 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F</th></tr></thead><tbody><tr><td><strong>Path</strong></td><td>\u043E\u043F\u0438\u0441\u044B\u0432\u0430\u0435\u0442 uri \u043F\u0443\u0442\u044C, \u043D\u0430 \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u0434\u043E\u043B\u0436\u0435\u043D \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u0442\u044C\u0441\u044F \u0441\u043B\u043E\u0439, \u043C\u043E\u0436\u0440\u043E \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043B\u043E\u0432\u0430\u0442\u044C \u0440\u0435\u0433\u0443\u043B\u044F\u0440\u043A\u0438, \u0431\u0435\u0437 \u0443\u043A\u0430\u0437\u0430\u0440\u0438\u044F \u044D\u0442\u043E\u0433\u043E \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u0430 \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 uri</td><td>-</td><td><code>/users/{id}/</code></td></tr><tr><td><strong>Name</strong></td><td>\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u044F\u0435\u043C \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u043E\u0435 \u0438\u043C\u044F \u0441\u043B\u043E\u044F, \u0447\u0435\u0440\u0435\u0437 \u044D\u0442\u043E \u0438\u043C\u044F \u043C\u043E\u0436\u043D\u043E \u0431\u0443\u0434\u0435\u0442 \u043D\u0430\u0439\u0442\u0438 \u0441\u043B\u043E\u0439 (\u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E \u0432\u0441\u0435 \u0441\u043B\u043E\u0438 \u043F\u043E\u043B\u0443\u0447\u0430\u044E\u0442 \u0438\u043C\u0435\u043D\u0430 \u0432\u0438\u0434\u0430 <code>l-0</code>, <code>l-1</code>, <code>l-2</code>, \u0438 \u0442.\u0434.)</td><td>-</td><td><code>usersAction</code></td></tr><tr><td><strong>Methods</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0438\u0437 http \u043C\u0435\u0442\u043E\u0434\u043E\u0432, \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0442\u043E\u043B\u044C\u043A\u043E \u043D\u0430 http \u0437\u0430\u043F\u0440\u043E\u0441\u044B \u0441 \u0443\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u043C\u0438 http \u043C\u0435\u0442\u043E\u0434\u0430\u043C\u0438. \u0415\u0441\u043B\u0438 \u043C\u0435\u0442\u043E\u0434\u044B \u043D\u0435 \u043F\u0435\u0440\u0435\u0434\u0430\u043D\u044B, \u0442\u043E \u0441\u043B\u043E\u0439 \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043D\u0430 \u043B\u044E\u0431\u043E\u0439 http \u043C\u0435\u0442\u043E\u0434</td><td><code>[]</code></td><td><code>[&#39;GET&#39;]</code></td></tr><tr><td><strong>Priority</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 <code>int</code> \u0447\u0438\u0441\u043B\u043E \u0441 \u043F\u0440\u0438\u043E\u0440\u0438\u0442\u0435\u0442\u043E\u043C, \u0447\u0435\u043C \u043D\u0438 \u043C\u0435\u043D\u044C\u0448\u0435 \u0447\u0438\u0441\u043B\u043E, \u0442\u0435\u043C \u0440\u0430\u043D\u044C\u0448\u0435 \u0432\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u0441\u044F \u0441\u043B\u043E\u0439. \u042D\u0442\u043E \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0441\u043B\u043E\u0438 \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0435 \u0432 \u043F\u043E\u0440\u044F\u0434\u043A\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F</td><td><code>50</code></td><td><code>100</code></td></tr><tr><td><strong>Restrictions</strong></td><td>\u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u043C\u0430\u0441\u0441\u0438\u0432 \u0432\u0438\u0434\u0430 [&#39;id&#39; =&gt; \\id+], \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044F \u043D\u0430\u043A\u043B\u0430\u0434\u044B\u0432\u0430\u0442\u044C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u044F \u043D\u0430 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B \u0432 uri \u0437\u0430\u043F\u0440\u043E\u0441\u0430</td><td><code>[]</code></td><td><code>[&#39;id&#39;=&gt;&#39;\\d+&#39;]</code></td></tr><tr><td><strong>Context</strong></td><td>\u043F\u043E\u0437\u0432\u043E\u043B\u044F\u0435\u0442 \u043F\u0440\u0438\u043A\u0440\u0435\u043F\u0438\u0442\u044C \u043A \u0441\u043B\u043E\u044E \u043B\u044E\u0431\u044B\u0435 \u043F\u0440\u043E\u0438\u0437\u0432\u043E\u043B\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435</td><td><code>[]</code></td><td><code>[&#39;foo&#39;=&gt;&#39;bar&#39;]</code></td></tr></tbody></table><p>\u041F\u0440\u0438\u043C\u0435\u0440 \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F options \u0432 \u043A\u043E\u0434\u0435:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	<span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	handler <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		name<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">UriParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`Hello \`</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		<span class="token string">\`Path\`</span><span class="token punctuation">:</span>     <span class="token string">\`/hello/{name}/\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Name\`</span><span class="token punctuation">:</span>     <span class="token string">\`HelloAction\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Methods\`</span><span class="token punctuation">:</span>  <span class="token string">\`GET|POST\`</span><span class="token punctuation">,</span>
		<span class="token string">\`Priority\`</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
		<span class="token string">\`Restrictions\`</span><span class="token punctuation">:</span> next<span class="token punctuation">.</span>Restrictions<span class="token punctuation">{</span>
			<span class="token string">\`name\`</span><span class="token punctuation">:</span> <span class="token string">\`[a-z]+\`</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> app<span class="token punctuation">.</span>FasthttpHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="fast-http-methods" tabindex="-1"><a class="header-anchor" href="#fast-http-methods" aria-hidden="true">#</a> Fast http methods</h3><p>\u0414\u043B\u044F \u0443\u043F\u0440\u043E\u0449\u0435\u043D\u0438\u044F \u0442\u0430\u043A\u0436\u0435 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B \u043C\u0435\u0442\u043E\u0434\u044B, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0437\u0435\u0440\u043A\u0430\u043B\u0438\u0440\u0443\u044E\u0442 \u043E\u0441\u043D\u043E\u0432\u043D\u044B\u0435 http \u043C\u0435\u0442\u043E\u0434\u044B, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>app <span class="token operator">:=</span> <span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

handler <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>layer<span class="token punctuation">.</span>Ctx<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span>LayersStore<span class="token punctuation">.</span>
	<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Patch</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span>
	<span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">\`/users/{id}/\`</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="declarative-configuration" tabindex="-1"><a class="header-anchor" href="#declarative-configuration" aria-hidden="true">#</a> Declarative configuration</h3><p>\u041E\u0447\u0435\u043D\u044C \u0443\u0434\u043E\u0431\u043D\u043E \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043C\u0430\u0440\u0448\u0440\u0443\u0442\u044B \u0438 \u043F\u043E\u0440\u044F\u0434\u043E\u043A \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E, \u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C yml \u0444\u0430\u0439\u043B\u043E\u0432, \u043F\u0440\u043E\u0441\u0442\u043E\u0439 \u043F\u0440\u0438\u043C\u0435\u0440 \u0442\u0430\u043A\u043E\u0439 \u043A\u043E\u043D\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u0442\u0430\u043A:</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># middlewares</span>
  @todo \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0440\u0438\u043C\u0435\u0440

<span class="token comment"># 404 page</span>
  @todo \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0440\u0438\u043C\u0435\u0440

<span class="token comment"># actions</span>
  @todo \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u0440\u0438\u043C\u0435\u0440
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u041C\u043E\u0436\u043D\u043E \u043D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u0441\u0432\u043E\u044E \u0441\u0442\u0440\u0430\u0442\u0435\u0433\u0438\u044E, \u043F\u043E \u043A\u043E\u0442\u043E\u0440\u043E\u0439 \u0434\u0435\u043A\u043B\u0430\u0440\u0430\u0442\u0438\u0432\u043D\u043E \u0431\u0443\u0434\u0435\u0442 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043D\u044B \u0441\u043B\u043E\u0438, \u043F\u043E\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u043E\u043C \u0440\u0435\u0430\u043B\u0437\u0438\u0430\u0446\u0438\u0438 <code>FactoryContract</code></p><h3 id="flow" tabindex="-1"><a class="header-anchor" href="#flow" aria-hidden="true">#</a> Flow</h3><p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u0434\u043E \u0432\u044B\u0437\u043E\u0432\u0430 <code>ctx-&gt;Next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u0442\u0430\u043A\u0436\u0435 \u043C\u043E\u0436\u0435\u0442 \u0447\u0442\u043E-\u0442\u043E \u0434\u0435\u043B\u0430\u0442\u044C \u043F\u043E\u0441\u043B\u0435 \u0432\u044B\u0437\u043E\u0432\u0430 <code>ctx-&gt;Next()</code> \u043D\u0430 \u044D\u0442\u0430\u043F\u0435 \u043E\u0442\u0432\u0435\u0442\u0430. \u041F\u0440\u0438\u043C\u0435\u0440 \u043F\u043E\u043B\u043D\u043E\u0433\u043E \u0432\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043F\u0440\u043E\u0441\u0430, \u043A\u043E\u0442\u043E\u0440\u044B\u0439 \u043F\u0440\u043E\u0445\u043E\u0434\u0438\u0442 \u0441\u043A\u0432\u043E\u0437\u044C \u0432\u0441\u0435 \u0441\u043B\u043E\u0438:</p><p><img src="`+i+'" alt="200 flow"></p><p>\u041F\u0440\u0438\u043C\u0435\u0440 flow, \u043A\u043E\u0433\u0430 \u0437\u0430\u043F\u0440\u043E\u0441 \u0434\u043E\u0441\u0440\u043E\u0447\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u043D \u043E\u0434\u043D\u0438\u043C \u0438\u0437 \u0441\u043B\u043E\u0435\u0432, \u0431\u0435\u0437 \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u0447\u0435\u0440\u0435\u0437 <code>ctx-&gt;Next()</code>:</p><p><img src="'+l+'" alt="401 flow"></p>',41),U=o(`<p>\u041A\u0430\u0436\u0434\u044B\u0439 \u0441\u043B\u043E\u0439 \u0440\u0435\u0448\u0430\u0435\u0442 \u0441\u0430\u043C, \u0441\u043E\u0437\u0434\u0430\u0442\u044C http response \u0438 \u043F\u0440\u0435\u043A\u0442\u0430\u0442\u0438\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443, \u043B\u0438\u0431\u043E \u0432\u044B\u0437\u0432\u0430\u0442\u044C \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0438\u0439 \u0441\u043B\u043E\u0439 \u0438 \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0435\u043C\u0443 \u0442\u0435\u043C \u0441\u0430\u043C\u044B\u043C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443.</p><h2 id="fasthttp" tabindex="-1"><a class="header-anchor" href="#fasthttp" aria-hidden="true">#</a> Fasthttp</h2><h3 id="integration" tabindex="-1"><a class="header-anchor" href="#integration" aria-hidden="true">#</a> Integration</h3><p>\u041F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u0443\u0435\u0442 \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0430 <code>fasthttp.RequestCtx</code>. \u0417\u0430 \u0441\u0447\u0435\u0442 \u044D\u0442\u043E\u0433\u043E \u043E\u043D\u043E \u043C\u043E\u0436\u0435\u0442 \u0438\u043D\u0442\u0435\u0433\u0440\u0438\u0440\u043E\u0432\u0442\u044C\u0441\u044F \u0432 \u043B\u044E\u0431\u044B\u0435 \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F fasthttp \u043A\u0430\u043A middleware, \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044F \u043D\u0430 \u0432\u0445\u043E\u0434 <code>fasthttp.RequestCtx</code>.</p><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>fasthttp</code> -&gt; <code>fasthttp</code> -&gt; <code>next</code>.</p><hr><p>\u0415\u0441\u043B\u0438 \u043C\u0438\u043A\u0440\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435 \u0434\u043E\u043B\u0436\u043D\u043E \u0434\u0435\u043B\u0435\u0433\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0430 \u0434\u0430\u043B\u0435\u0435 \u0432 \u043A\u043B\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043A\u043E\u0435 <code>fasthttp</code> \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u0435, \u0442\u043E \u043C\u043E\u0436\u043D\u043E \u043E\u0431\u0435\u0440\u043D\u0443\u0442\u044C \u0432 \u0442\u0430\u043A\u0443\u044E middleware:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;github.com/valyala/fasthttp&quot;</span>

	next2 <span class="token string">&quot;github.com/alexpts/go-next/next&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">appToFasthttpMiddleware</span><span class="token punctuation">(</span>app next2<span class="token punctuation">.</span>App<span class="token punctuation">,</span> handler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next2<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next2<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">handler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token keyword">return</span> app<span class="token punctuation">.</span>FasthttpHandler
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler1</span><span class="token punctuation">(</span>requestHandler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-1-\`</span><span class="token punctuation">)</span>
		<span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler2</span><span class="token punctuation">(</span>requestHandler fasthttp<span class="token punctuation">.</span>RequestHandler<span class="token punctuation">)</span> fasthttp<span class="token punctuation">.</span>RequestHandler <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-2-\`</span><span class="token punctuation">)</span>
		<span class="token function">requestHandler</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">handler3</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>fasthttp<span class="token punctuation">.</span>RequestCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`fasthttp-3-\`</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	app <span class="token operator">:=</span> next2<span class="token punctuation">.</span><span class="token function">NewApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	app<span class="token punctuation">.</span><span class="token function">Use</span><span class="token punctuation">(</span>next2<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx <span class="token operator">*</span>next2<span class="token punctuation">.</span>HandlerCxt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>Response<span class="token punctuation">.</span><span class="token function">AppendBodyString</span><span class="token punctuation">(</span><span class="token string">\`next-1-\`</span><span class="token punctuation">)</span>
		ctx<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	afterHandler <span class="token operator">:=</span> <span class="token function">handler2</span><span class="token punctuation">(</span>handler3<span class="token punctuation">)</span>
	appHandler <span class="token operator">:=</span> <span class="token function">appToFasthttpMiddleware</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> afterHandler<span class="token punctuation">)</span> <span class="token comment">// app as middleware of fasthttp + delegate to next handler</span>
	allHandler <span class="token operator">:=</span> <span class="token function">handler1</span><span class="token punctuation">(</span>appHandler<span class="token punctuation">)</span>

	server <span class="token operator">:=</span> <span class="token operator">&amp;</span>fasthttp<span class="token punctuation">.</span>Server<span class="token punctuation">{</span>
		Handler<span class="token punctuation">:</span> allHandler<span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	<span class="token boolean">_</span> <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">&quot;:3000&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><div class="highlight-line">\xA0</div><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u0421\u0445\u0435\u043C\u0430\u0442\u0438\u0447\u043D\u043E \u044D\u0442\u043E \u0432\u044B\u0433\u043B\u044F\u0434\u0438\u0442 \u043A\u0430\u043A <code>fasthttp (handler1)</code> -&gt; <code>next</code> -&gt; <code>fasthttp (handler2)</code> -&gt; <code>fasthttp (handler 3)</code>.</p><p>\u0422\u0430\u043A\u0438\u0435 \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438 \u043F\u043E\u0437\u0432\u043E\u043B\u044F\u044E\u0442 \u0442\u043E\u0447\u0435\u0447\u043D\u043E \u0437\u0430\u043C\u0435\u043D\u044F\u0442\u044C \u0447\u0430\u0441\u0442\u0438 \u0441\u0442\u0430\u0440\u043E\u0433\u043E \u043F\u0440\u0438\u043B\u043E\u0436\u0435\u043D\u0438\u044F \u0438\u043B\u0438 \u043F\u0435\u0440\u0435\u043D\u043E\u0441\u0438\u0442\u044C \u043D\u0435\u0431\u043E\u043B\u044C\u0448\u0438\u043C\u0438 \u043A\u0443\u0441\u043E\u0447\u043A\u0430\u043C\u0438 \u0447\u0430\u0441\u0442\u044C \u0444\u0443\u043D\u043A\u0446\u0438\u043E\u043D\u0430\u043B\u0430.</p>`,10);function M(G,T){const t=p("router-link"),c=p("ExternalLinkIcon");return d(),r("div",null,[h,n("nav",b,[n("ul",null,[n("li",null,[a(t,{to:"#hello-world"},{default:e(()=>[m]),_:1})]),n("li",null,[a(t,{to:"#glossary"},{default:e(()=>[g]),_:1})]),n("li",null,[a(t,{to:"#layers-store"},{default:e(()=>[f]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#handler"},{default:e(()=>[x]),_:1})]),n("li",null,[a(t,{to:"#options"},{default:e(()=>[y]),_:1})]),n("li",null,[a(t,{to:"#fast-http-methods"},{default:e(()=>[_]),_:1})]),n("li",null,[a(t,{to:"#declarative-configuration"},{default:e(()=>[w]),_:1})]),n("li",null,[a(t,{to:"#flow"},{default:e(()=>[q]),_:1})])])]),n("li",null,[a(t,{to:"#fasthttp"},{default:e(()=>[H]),_:1}),n("ul",null,[n("li",null,[a(t,{to:"#integration"},{default:e(()=>[A]),_:1})])])])])]),C,n("div",R,[S,n("p",null,[L,n("a",N,[F,a(c)]),B])]),P,k(`
\`\`\`yml
@startuml
scale 1.3
title: 401 response

Client -> App: http request
    activate App
    App -> "Auth Layer": request
    
        activate "Auth Layer"
        "Auth Layer" -> App: 401 response
        deactivate "Auth Layer"
    
    App -> Client: http response
    deactivate App
@enduml
\`\`\`
`),U])}const I=u(v,[["render",M],["__file","index.html.vue"]]);export{I as default};
